<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Задание №3</title>
</head>
<body>
<div id="content"></div>
<script type="text/javascript">
    content.innerHTML = "";
    let n = 0;
    const startTime = Date.now();
    let completedRequests = 0;
    const totalRequests = 21;

    for (let i = 0; i < totalRequests; i++) {
        fetch(`/fact?k=${i}`, {method: "GET", mode: "no-cors", headers: {'Accept': 'application/json'}})
            .then(response => response.json())
            .then(pdata => {
                content.innerHTML += (n++) + ". Результат: " + (Date.now() - startTime) + 
                    'ms - ' + pdata.k + "/" + pdata.fact + "<br/>";
            
                completedRequests++;
            
                if (completedRequests === totalRequests) {
                    const totalTime = Date.now() - startTime;
                    content.innerHTML += `<br/><strong>ОБЩЕЕ ВРЕМЯ ВСЕХ ЗАПРОСОВ: ${totalTime}ms</strong><br/>`;
                }
            })
    }
</script>
</body>
</html>